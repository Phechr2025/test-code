{% extends "base.html" %}
{% block title %}จัดการผู้ใช้{% endblock %}

{% block content %}
<h1>จัดการผู้ใช้</h1>

<form method="get" class="form" style="max-width:420px;margin-bottom:1rem;">
  <label for="q">ค้นหาผู้ใช้ (ชื่อหรือ key)</label>
  <input
    type="text"
    id="q"
    name="q"
    value="{{ q or '' }}"
    placeholder="กรอกชื่อผู้ใช้หรือ key"
  />
  <button type="submit" class="btn primary">ค้นหา</button>
</form>

{% if users and users|length > 0 %}
<table class="table">
  <thead>
    <tr>
      <th>ID</th>
      <th>ชื่อผู้ใช้</th>
      <th>Key</th>
      <th>สมัครเมื่อ</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
  {% for u in users %}
    <tr>
      <td>{{ u['id'] }}</td>
      <td>{{ u['username'] }}</td>
      <td>{{ u['user_key'] or '-' }}</td>
      <td>{{ u['created_at'] }}</td>
      <td>
        <a href="{{ url_for('admin_user_detail', user_id=u['id']) }}" class="btn primary">จัดการ</a>
      </td>
    </tr>
  {% endfor %}
  </tbody>
</table>
{% else %}
<p>ยังไม่มีผู้ใช้ หรือไม่พบข้อมูลที่ค้นหา</p>
{% endif %}
{% endblock %}
