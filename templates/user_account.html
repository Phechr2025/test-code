{% extends "base.html" %}
{% block title %}บัญชีของฉัน{% endblock %}

{% block content %}
<h1>บัญชีของฉัน</h1>

<p style="margin-bottom:0.75rem;">ชื่อผู้ใช้ปัจจุบัน: <strong>{{ user['username'] }}</strong></p>

<div class="form" style="margin-bottom:1rem;">
  <label for="user_key">คีย์บัญชี (ใช้ให้แอดมินค้นหา)</label>
  <div style="display:flex; gap:0.5rem; align-items:center;">
    <input type="text" id="user_key" value="{{ user['user_key'] or '' }}" readonly style="flex:1;" />
    <button type="button" class="btn" onclick="copyUserKey()">คัดลอก</button>
  </div>
  <form method="post" style="margin-top:0.75rem;" onsubmit="return confirm('ต้องการรีเซ็ต key ใหม่หรือไม่? key เก่าจะใช้ไม่ได้');">
    <input type="hidden" name="action" value="reset_key" />
    <button type="submit" class="btn danger">รีเซ็ต key ใหม่</button>
  </form>
</div>

<form method="post" class="form">
  <input type="hidden" name="action" value="change_password" />
  <label for="current_password">รหัสผ่านเดิม</label>
  <input type="password" id="current_password" name="current_password" required />

  <label for="new_password">รหัสผ่านใหม่</label>
  <input type="password" id="new_password" name="new_password" required />

  <label for="confirm_password">ยืนยันรหัสผ่านใหม่</label>
  <input type="password" id="confirm_password" name="confirm_password" required />

  <button type="submit" class="btn primary">บันทึกการเปลี่ยนแปลง</button>
</form>
{% endblock %}
